<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3D Image with Dynamic RGB Lighting</title>
<style>
body {
  margin:0; height:100vh; overflow:hidden;
  background:#111;
  display:flex; justify-content:center; align-items:center;
  perspective:1200px;
  font-family:'Segoe UI', sans-serif; color:#fff;
}

.scene {
  position:relative;
  width:50%;
  height:90%;
  transform-style: preserve-3d;
  cursor:default;
  display:flex;
  justify-content:center;
  align-items:center;
  border-radius:20px;
  overflow:hidden;
}

.scene img {
  width:auto; height:100%;
  object-fit:contain;
  border-radius:20px;
  box-shadow:
    0 30px 50px rgba(0,0,0,0.6),
    0 0 80px rgba(255,255,255,0.05) inset;
  transform:rotateX(0deg) rotateY(0deg) translateZ(0px) scale(1);
  transition: transform 0.1s ease, filter 0.2s ease;
  filter: brightness(1) contrast(1) drop-shadow(0 10px 10px rgba(0,0,0,0.5));
  user-select:none; pointer-events:none;
  position:relative;
}

/* 반사광 레이어 */
.scene::after {
  content:"";
  position:absolute;
  top:0; left:0;
  width:100%; height:100%;
  pointer-events:none;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.3) 0%, transparent 70%);
  opacity:0.3;
  mix-blend-mode:screen;
  transition: background-position 0.1s ease, opacity 0.1s ease;
}

.drag-overlay {
  position:absolute;
  border:3px dashed #0f0;
  border-radius:25px;
  pointer-events:none;
  opacity:0;
  transition: opacity 0.2s, transform 0.2s;
}
.drag-overlay.active { opacity:1; }

.control-card {
  position:fixed; top:20px; right:20px;
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius:16px; padding:16px;
  box-shadow:0 4px 12px rgba(0,0,0,0.4);
  width:300px; z-index:9999;
}

.control-card h3 { margin-top:0; font-size:1.1em; text-align:center; }
.control { margin-bottom:12px; }
.control label { font-size:0.9em; display:block; margin-bottom:4px; }
.control input[type='range'] { width:100%; }

</style>
</head>
<body>

<div class="scene" id="scene">
  <img id="bgImage" src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1000&q=80" draggable="false" />
  <div class="drag-overlay" id="dragOverlay"></div>
</div>

<div class="control-card">
  <h3>3D Controls</h3>
  <div class="control"><label for="translateZ">Depth (Z)</label><input type="range" id="translateZ" min="0" max="200" value="0"></div>
  <div class="control"><label for="scale">Scale</label><input type="range" id="scale" min="0.5" max="2" step="0.01" value="1"></div>
  <div class="control"><label for="blur">Blur</label><input type="range" id="blur" min="0" max="10" step="0.1" value="0"></div>
  <div class="control"><label for="brightness">Brightness</label><input type="range" id="brightness" min="0.5" max="2" step="0.01" value="1"></div>
</div>

<script>
const img = document.getElementById('bgImage');
const scene = document.getElementById('scene');
const translateZ = document.getElementById('translateZ');
const scale = document.getElementById('scale');
const blur = document.getElementById('blur');
const brightness = document.getElementById('brightness');

let mouseX = window.innerWidth/2;
let mouseY = window.innerHeight/2;

// 마우스 위치 기반 회전 + RGB 조명
document.addEventListener('mousemove', e=>{
  mouseX = e.clientX;
  mouseY = e.clientY;
  updateTransform();
});

function updateTransform(){
  const centerX = window.innerWidth/2;
  const centerY = window.innerHeight/2;
  const deltaX = mouseX - centerX;
  const deltaY = mouseY - centerY;

  const rotY = deltaX * 0.03;
  const rotX = -deltaY * 0.03;

  const z = translateZ.value;
  const s = scale.value;
  const b = brightness.value;
  const bl = blur.value;

  // 그림자 이동
  const shadowX = deltaX/centerX*30;
  const shadowY = deltaY/centerY*30;

  // RGB 조명
  const r = Math.min(Math.max(128 + deltaX/centerX*127,0),255);
  const g = Math.min(Math.max(128 + deltaY/centerY*127,0),255);
  const bRGB = Math.min(Math.max(200 - deltaY/centerY*100,0),255);

  const shadowColor = `rgba(${r},${g},${bRGB},0.25)`;

  // 이미지 transform + filter
  img.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg) translateZ(${z}px) scale(${s})`;
  img.style.filter = `
    brightness(${b})
    blur(${bl}px)
    drop-shadow(${shadowX}px ${shadowY}px 20px ${shadowColor})
  `;

  // 반사광 위치 업데이트
  const gradientX = 50 + deltaX/centerX*20;
  const gradientY = 50 + deltaY/centerY*20;
  scene.style.background = `radial-gradient(circle at ${gradientX}% ${gradientY}%, rgba(${r},${g},${bRGB},0.2), transparent 70%)`;
}

// 컨트롤 슬라이더 적용
[translateZ, scale, blur, brightness].forEach(input=>{
  input.addEventListener('input', updateTransform);
});
</script>

</body>
</html>
